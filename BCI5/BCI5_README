#CHO2017 데이터셋 사용(https://neurotechx.github.io/moabb/generated/moabb.datasets.Cho2017.html#moabb.datasets.Cho2017)
#fb_CSP 알고리즘 사용
#LDA 이진 분류 알고리즘 사용

로지스틱 회귀 알고리즘(이진 분류 알고리즘)
대신에 LDA(Linear Discriminant Analysis) 사용

#CHO2017 데이터셋 : 운동 상상 실험을 기반으로 수집된 EEG 데이터. 64개의 EEG 전극 사용, 좌/우측 손 운동 상상 & 발 운동 상상 과 


#CSP(Common Spatial Pattern) : 특정 공간적 패턴을 강조하여 클래스 간 차이를 극대화하는 필터를 학습하고(각 분산이 커지는 방향),
                               그 필터(가중치 행렬 W)를 EEG 데이터에 적용해서 더 구별 가능한 신호 특징을 추출하는 것이 목적
CSP는 각 클래스(예: 좌측/우측 손)에서 신호의 분산 차이를 극대화하는 방향으로 EEG 데이터를 변환하는 필터를 학습
한 클래스에서는 신호가 강조되고, 다른 클래스에서는 신호가 약해지는 패턴을 만듦


#filter bank CSP : CSP를 여러개의 주파수 대역에서 적용하여 특징을 추출하는 방법(뇌파 신호에서 중요한 주파수 대역을 선택)
기본 CSP는 **전체 EEG 신호(0~40Hz)**를 한꺼번에 처리하지만, EEG 신호는 다양한 주파수 대역에서 다른 의미를 가짐
-> 기본 CSP는 이러한 주파수 특성을 고려하지 않고 전체 신호를 사용하기 때문에, 분류 성능이 떨어질 수 있음
-> 때문에 주파수 대역별 CSP를 수행하는 FB_CSP가 더욱 강력
1. EEG 신호를 여러 개의 주파수 대역으로 분할
2. 각 주파수 대역에서 CSP를 적용하여 개별적인 특징을 추출
3. 여러 주파수 대역의 CSP 특징을 결합하여 최종 특징 벡터를 생성

FBCSP는 CSP를 여러 개의 주파수 대역에서 동시에 적용하여 EEG 신호의 중요한 정보를 더 많이 추출하는 기법


#LDA(Linear Discriminant Analysis) : 두 개 이상의 클래스를 구별하는 방향으로 데이터를 변환하는 차원 축소 및 분류 알고리즘
클래스 간 분산을 최대화하고, 클래스 내부 분산을 최소화하는 방향으로 데이터 포인트 들을 투영 분류 성능을 향상시키는 기법

투영을 통해 가능한 한 클래스를 멀리 떨어지게 하므로 SVM 같은 다른 분류 알고리즘을 적용하기 전에 차원을 축소시키는 데 사용하면 좋음
목적 : 가능한 클래스 간의 분별 정보를 최대한 유지시키면서 차원을 축소시키는 것(투영)
(https://velog.io/@swan9405/LDA-Linear-Discriminant-Analysis)

task : LDA vs PCA ?



-----------------------------------------------------------------------------------------------------------------------------------------------------------

<Main Idea>
CHO2017 데이터셋의 EEG 데이터를 통해 특정 뇌파 신호에서 왼손 운동상상이 발생했는지, 오른손 운동상상이 발생했는지를 분류
(뇌파 신호로만 어떤 쪽 운동상상이 발생했는지 추측하고 분류하는 알고리즘)
# CHO2017 데이터셋을 'filter bank csp'를 통해 두 클래스 간의 분산이 큰 차이가 나는 방향으로 처리
# fb_csp를 통해 각 클래스별 분산 방향으로 퍼지게 바꾼 데이터셋에 대해 'LDA'를 통해 이진 분류 수행
# LDA는 데이터들을 나누도록 선을 긋는 선형 이진분류 알고리즘과 달리, 데이터들을 선에 '투영'했을 때 잘 분류하는 축을 설정하는 이진분류 알고리즘


1. CHO2017 데이터셋 불러오기(데이터셋 다운로드 시 MOABB 서버 연결 끊어지는 문제 발생, 부득이하게 colab에서 진행)
2. 불러온 데이터셋 형태 확인
3. filter bank csp이므로, 주파수 대역별 csp를 수행하므로 freq_band 설정
4. apply_fbcsp 함수를 통해 대역 필터링, csp 적용 후, 모든 대역의 특징을 결합하여 반환
5. fb_csp 특징 추출
6. 훈련/테스트 데이터셋으로 분할
7. LDA를 통해 데이터 이진 분류 수행(왼손/오른손)
8. CSP 필터 패턴 시각화

#CSP 필터 패턴 : 
- 색이 짙은 전극 → 중요한 특징을 가지는 위치
(예: 운동 상상 시 신호 변화가 강한 전극)

- 붉은색(양의 값) → 한 클래스에서 강한 활성화
(예: 좌측 운동 상상 시 활성화되는 전극)

- 푸른색(음의 값) → 다른 클래스에서 강한 활성화
(예: 우측 운동 상상 시 활성화되는 전극)

- 두피에서 신호가 강한 부분을 강조하여 시각적으로 볼 수 있음




